<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Test - Genre of Design</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold mb-8">API Test Page</h1>
        
        <div class="space-y-6">
            <!-- API Health Check -->
            <div class="bg-white p-6 rounded-lg shadow">
                <h2 class="text-xl font-semibold mb-4">API Health Check</h2>
                <button onclick="testHealth()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
                    Test API Health
                </button>
                <div id="health-result" class="mt-4 p-4 bg-gray-100 rounded hidden">
                    <pre id="health-output"></pre>
                </div>
            </div>

            <!-- Database Test -->
            <div class="bg-white p-6 rounded-lg shadow">
                <h2 class="text-xl font-semibold mb-4">Database Test</h2>
                <button onclick="testDatabase()" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">
                    Test Database Connection
                </button>
                <div id="db-result" class="mt-4 p-4 bg-gray-100 rounded hidden">
                    <pre id="db-output"></pre>
                </div>
            </div>

            <!-- Landing Pages Test -->
            <div class="bg-white p-6 rounded-lg shadow">
                <h2 class="text-xl font-semibold mb-4">Landing Pages Test</h2>
                <button onclick="testLandingPages()" class="bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600">
                    Test Landing Pages API
                </button>
                <div id="lp-result" class="mt-4 p-4 bg-gray-100 rounded hidden">
                    <pre id="lp-output"></pre>
                </div>
            </div>

            <!-- All Tests -->
            <div class="bg-white p-6 rounded-lg shadow">
                <h2 class="text-xl font-semibold mb-4">Run All Tests</h2>
                <button onclick="runAllTests()" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">
                    Run All Tests
                </button>
                <div id="all-results" class="mt-4 space-y-4"></div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE_URL = 'https://god-public-api.restless-mountain-f968.workers.dev/api';

        async function testHealth() {
            try {
                const response = await fetch(API_BASE_URL);
                const data = await response.json();
                document.getElementById('health-result').classList.remove('hidden');
                document.getElementById('health-output').textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                document.getElementById('health-result').classList.remove('hidden');
                document.getElementById('health-output').textContent = 'Error: ' + error.message;
            }
        }

        async function testDatabase() {
            try {
                const response = await fetch(API_BASE_URL.replace('/api', '/test-db'));
                const data = await response.json();
                document.getElementById('db-result').classList.remove('hidden');
                document.getElementById('db-output').textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                document.getElementById('db-result').classList.remove('hidden');
                document.getElementById('db-output').textContent = 'Error: ' + error.message;
            }
        }

        async function testLandingPages() {
            try {
                const response = await fetch(`${API_BASE_URL}/landing-pages`);
                const data = await response.json();
                document.getElementById('lp-result').classList.remove('hidden');
                document.getElementById('lp-output').textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                document.getElementById('lp-result').classList.remove('hidden');
                document.getElementById('lp-output').textContent = 'Error: ' + error.message;
            }
        }

        async function runAllTests() {
            const resultsDiv = document.getElementById('all-results');
            resultsDiv.innerHTML = '<div class="text-center">Running tests...</div>';

            const tests = [
                { name: 'API Health', fn: testHealth },
                { name: 'Database', fn: testDatabase },
                { name: 'Landing Pages', fn: testLandingPages }
            ];

            let results = '';
            for (const test of tests) {
                try {
                    results += `<div class="p-4 bg-blue-50 rounded"><strong>${test.name}:</strong> Running...</div>`;
                    resultsDiv.innerHTML = results;
                    
                    await test.fn();
                    results += `<div class="p-4 bg-green-50 rounded"><strong>${test.name}:</strong> ✅ Completed</div>`;
                } catch (error) {
                    results += `<div class="p-4 bg-red-50 rounded"><strong>${test.name}:</strong> ❌ Failed - ${error.message}</div>`;
                }
                resultsDiv.innerHTML = results;
            }
        }
    </script>
</body>
</html>
